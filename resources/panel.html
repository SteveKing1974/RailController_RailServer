<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Signal Box Panel</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

    <script>
        function togglePoint(name) {
            $.ajax({
                type: "PUT",
                url: "/railControl/panel/" + name,
                data: { "command": "toggle" },
                dataType:"json",
                success: function(data, textStatus, jqXHR) { handleReturn(data); },
                error: function(jqXHR, textStatus, errorThrown) { console.log( "error " + errorThrown); }
            });
        }

        function getState() {
            $.ajax({
                  type: "GET",
                  url: "/railControl/panel",
                  dataType:"json",
                  success: function(data, textStatus, jqXHR) {
                        handleReturn(data);
                        },
                  error: function(jqXHR, textStatus, errorThrown) { console.log( "error " + errorThrown); }
              });
        }

        function stateToImage(state) {
            switch (state)
            {
            case 1: return "png/greenindicator.png"
            case 2: return "png/redindicator.png"
            case 3: return "png/blueindicator.png"
            case 4: return "png/yellowindicator.png"
            }
            return "png/greyindicator.png"
        }

        function handleReturn(data) {
            $("#outerLeft").attr("src", stateToImage(data.nodes.outerLeft))

            $("#outerCenter").attr("src", stateToImage(data.nodes.outerCenter))
            $("#outerRight").attr("src", stateToImage(data.nodes.outerRight))
            $("#outerToInnerLeft").attr("src", stateToImage(data.nodes.outerToInnerLeft))
            $("#outerToInnerRight").attr("src", stateToImage(data.nodes.outerToInnerRight))
            $("#innerLeft").attr("src", stateToImage(data.nodes.innerLeft))
            $("#innerCenter").attr("src", stateToImage(data.nodes.innerCenter))
            $("#innerRight").attr("src", stateToImage(data.nodes.innerRight))
            $("#innerToStation").attr("src", stateToImage(data.nodes.innerToStation))
            $("#stationOuterLeft").attr("src", stateToImage(data.nodes.stationOuterLeft))
            $("#outerLeft").attr("src", stateToImage(data.nodes.outerLeft))
            $("#stationOuterCenter").attr("src", stateToImage(data.nodes.stationOuterCenter))
            $("#stationOuterRight").attr("src", stateToImage(data.nodes.stationOuterRight))
            $("#stationSidingRight1").attr("src", stateToImage(data.nodes.stationSidingRight1))
            $("#stationSidingRight2").attr("src", stateToImage(data.nodes.stationSidingRight2))
            $("#stationSidingRight3").attr("src", stateToImage(data.nodes.stationSidingRight3))

            $("#stationOuterToInnerLeft").attr("src", stateToImage(data.nodes.stationOuterToInnerLeft))
            $("#stationOuterToInnerRight").attr("src", stateToImage(data.nodes.stationOuterToInnerRight))
            $("#stationInnerCenter").attr("src", stateToImage(data.nodes.stationInnerCenter))
            $("#stationInnerRight").attr("src", stateToImage(data.nodes.stationInnerRight))
            $("#stationSidingLeft1").attr("src", stateToImage(data.nodes.stationSidingLeft1))
            $("#stationSidingLeft2").attr("src", stateToImage(data.nodes.stationSidingLeft2))
            $("#stationSidingLeft3").attr("src", stateToImage(data.nodes.stationSidingLeft3))


            $("#upmaincrossover_img").attr("src", "png/upmaincrossover_" + (data.points.upmaincrossover.direction == 0 ? "off" : "on") + ".png")
            $("#upmaincrossover_img").attr("style", (data.points.upmaincrossover.enabled ? "" : "opacity: 0.5") )

            $("#downmaincrossover_img").attr("src", "png/downmaincrossover_" + (data.points.downmaincrossover.direction == 0 ? "off" : "on") + ".png")
            $("#downmaincrossover_img").attr("style", (data.points.downmaincrossover.enabled ? "" : "opacity: 0.5") )

            $("#stationentrancecrossover_img").attr("src", "png/stationentrancecrossover_" + (data.points.stationentrancecrossover.direction == 0 ? "off" : "on") + ".png")
            $("#stationentrancecrossover_img").attr("style", (data.points.stationentrancecrossover.enabled ? "" : "opacity: 0.5") )

            $("#downstationcrossover_img").attr("src", "png/downstationcrossover_" + (data.points.downstationcrossover.direction == 0 ? "off" : "on") + ".png")
            $("#downstationcrossover_img").attr("style", (data.points.downstationcrossover.enabled ? "" : "opacity: 0.5") )

            $("#upstationcrossover_img").attr("src", "png/upstationcrossover_" + (data.points.upstationcrossover.direction == 0 ? "off" : "on") + ".png")
            $("#upstationcrossover_img").attr("style", (data.points.upstationcrossover.enabled ? "" : "opacity: 0.5") )

            $("#upsiding1_img").attr("src", "png/upsiding1_" + (data.points.upsiding1.direction == 0 ? "off" : "on") + ".png")
            $("#upsiding1_img").attr("style", (data.points.upsiding1.enabled ? "" : "opacity: 0.5") )

            $("#upsiding2_img").attr("src", "png/upsiding2_" + (data.points.upsiding2.direction == 0 ? "off" : "on") + ".png")
            $("#upsiding2_img").attr("style", (data.points.upsiding2.enabled ? "" : "opacity: 0.5") )

            $("#downsiding1_img").attr("src", "png/downsiding1_" + (data.points.downsiding1.direction == 0 ? "off" : "on") + ".png")
            $("#downsiding1_img").attr("style", (data.points.downsiding1.enabled ? "" : "opacity: 0.5") )

            $("#downsiding2_img").attr("src", "png/downsiding2_" + (data.points.downsiding2.direction == 0 ? "off" : "on") + ".png")
            $("#downsiding2_img").attr("style", (data.points.downsiding2.enabled ? "" : "opacity: 0.5") )
        }

        $(function() {
            $("#upmaincrossover").click(function() {togglePoint("upmaincrossover")})
            $("#downmaincrossover").click(function() {togglePoint("downmaincrossover")})
            $("#stationentrancecrossover").click(function() {togglePoint("stationentrancecrossover")})
            $("#downstationcrossover").click(function() {togglePoint("downstationcrossover")})
            $("#upstationcrossover").click(function() {togglePoint("upstationcrossover")})
            $("#upsiding1").click(function() {togglePoint("upsiding1")})
            $("#upsiding2").click(function() {togglePoint("upsiding2")})
            $("#downsiding1").click(function() {togglePoint("downsiding1")})
            $("#downsiding2").click(function() {togglePoint("downsiding2")})

            getState()
            })
    </script>
</head>
  
<body>
<div class="a" style="position:relative; height: 70px; margin-left: 50px">
<a class="btn btn-primary btn-lg" href="panel.html" role="button">Panel</a>
<a class="btn btn-default btn-lg" href="controllers.html" role="button">Controllers</a>
</div>

<div class="paneldiv" style="position:relative; width: 100%; height: 280px">
    <img src="png/panel.png" style="position: absolute; top:0; left:0; width:900px height: 250px">


    <!-- Outer -->
    <img id="outerLeft" src="png/greyindicator.png" style="position: absolute; top:208px; left:80px; width:16px height: 16px">
    <img id="outerCenter" src="png/greyindicator.png" style="position: absolute; top:206px; left:400px; width:16px height: 16px">
    <img id="outerRight" src="png/greyindicator.png" style="position: absolute; top:202px; left:820px; width:16px height: 16px">

    <!-- Outer to inner -->
    <img id="outerToInnerLeft" src="png/greyindicator.png" style="position: absolute; top:185px; left:198px; width:16px height: 16px">
    <img id="outerToInnerRight" src="png/greyindicator.png" style="position: absolute; top:182px; left:667px; width:16px height: 16px">

    <!-- Inner -->
    <img id="innerLeft" src="png/greyindicator.png" style="position: absolute; top:163px; left:80px; width:16px height: 16px">
    <img id="innerCenter" src="png/greyindicator.png" style="position: absolute; top:162px; left:400px; width:16px height: 16px">
    <img id="innerRight" src="png/greyindicator.png" style="position: absolute; top:160px; left:820px; width:16px height: 16px">

    <!-- Inner to station -->
    <img id="innerToStation" src="png/greyindicator.png" style="position: absolute; top:140px; left:595px; width:16px height: 16px">

    <!-- Station Outer -->
    <img id="stationOuterLeft" src="png/greyindicator.png" style="position: absolute; top:121px; left:160px; width:16px height: 16px">
    <img id="stationOuterCenter" src="png/greyindicator.png" style="position: absolute; top:119px; left:400px; width:16px height: 16px">
    <img id="stationOuterRight" src="png/greyindicator.png" style="position: absolute; top:117px; left:625px; width:16px height: 16px">

    <!-- Sidings right -->
    <img id="stationSidingRight1" src="png/greyindicator.png" style="position: absolute; top:116px; left:770px; width:16px height: 16px">
    <img id="stationSidingRight2" src="png/greyindicator.png" style="position: absolute; top:78px; left:770px; width:16px height: 16px">
    <img id="stationSidingRight3" src="png/greyindicator.png" style="position: absolute; top:44px; left:770px; width:16px height: 16px">


    <!-- Outer to inner -->
    <img id="stationOuterToInnerLeft" src="png/greyindicator.png" style="position: absolute; top:100px; left:268px; width:16px height: 16px">
    <img id="stationOuterToInnerRight" src="png/greyindicator.png" style="position: absolute; top:98px; left:518px; width:16px height: 16px">


    <!-- Station Inner -->
    <img id="stationInnerCenter" src="png/greyindicator.png" style="position: absolute; top:77px; left:400px; width:16px height: 16px">
    <img id="stationInnerRight" src="png/greyindicator.png" style="position: absolute; top:75px; left:555px; width:16px height: 16px">

    <!-- Sidings 1 -->
    <img id="stationSidingLeft1" src="png/greyindicator.png" style="position: absolute; top:79px; left:120px; width:16px height: 16px">
    <img id="stationSidingLeft2" src="png/greyindicator.png" style="position: absolute; top:39px; left:120px; width:16px height: 16px">
    <img id="stationSidingLeft3" src="png/greyindicator.png" style="position: absolute; top:7px; left:120px; width:16px height: 16px">

</div>
 
<div style="position:relative; margin-left: 50px">
 <div id="upmaincrossover" style="display: inline-block"><img           id="upmaincrossover_img" src="png/upmaincrossover_off.png"></div>
 <div id="downmaincrossover" style="display: inline-block"><img         id="downmaincrossover_img" src="png/downmaincrossover_off.png"></div>
 <div id="stationentrancecrossover" style="display: inline-block"><img  id="stationentrancecrossover_img" src="png/stationentrancecrossover_off.png"></div>
 <div id="downstationcrossover" style="display: inline-block"><img      id="downstationcrossover_img" src="png/downstationcrossover_off.png"></div>
 <div id="upstationcrossover" style="display: inline-block"><img        id="upstationcrossover_img" src="png/upstationcrossover_off.png"></div>
 <div id="upsiding1" style="display: inline-block"><img                 id="upsiding1_img" src="png/upsiding1_off.png"></div>
 <div id="upsiding2" style="display: inline-block"><img                 id="upsiding2_img" src="png/upsiding2_off.png"></div>
 <div id="downsiding1" style="display: inline-block"><img               id="downsiding1_img" src="png/downsiding1_off.png"></div>
 <div id="downsiding2" style="display: inline-block"><img               id="downsiding2_img" src="png/downsiding2_off.png"></div>
</div>
</body>
</html>
