<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Signal Box Panel</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
    <link rel="stylesheet" type="text/css" href="panel-style.css">
    <script>
        function togglePoint(name) {
            $.ajax({
                type: "PUT",
                url: "/railControl/panel/" + name,
                data: { "command": "toggle" },
                dataType:"json",
                success: function(data, textStatus, jqXHR) { handleReturn(data); },
                error: function(jqXHR, textStatus, errorThrown) { console.log( "error " + errorThrown); }
            });
        }

        function getState() {
            $.ajax({
                  type: "GET",
                  url: "/railControl/panel",
                  dataType:"json",
                  success: function(data, textStatus, jqXHR) {
                        handleReturn(data);
                        },
                  error: function(jqXHR, textStatus, errorThrown) { console.log( "error " + errorThrown); }
              });
        }

        function stateToImage(state) {
            switch (state)
            {
            case 1: return "png/greenindicator.png"
            case 2: return "png/redindicator.png"
            case 3: return "png/blueindicator.png"
            case 4: return "png/yellowindicator.png"
            }
            return "png/greyindicator.png"
        }

        function setPointImage(name, value, upperAndLower)
        {
            if (upperAndLower)
            {
                $(name + "Lower").attr("style", (value ? "opacity: 0" : "opacity: 0.5"))
                $(name + "Upper").attr("style", (value ? "opacity: 0" : "opacity: 0.5"))
            }
            else
            {
                $(name).attr("style", (value ? "opacity: 0" : "opacity: 0.5"))
            }

            $(name + "Lever_img").attr("src", "png/" + name.slice(1) + "Lever_" + (value == 0 ? "off" : "on") + ".png")
        }

        function handleReturn(data) {

            setPointImage("#upMainCrossOver", data.points.upmaincrossover.direction, true)

            setPointImage("#downMainCrossOver", data.points.downmaincrossover.direction, true)

            setPointImage("#stationEntrance", data.points.stationentrancecrossover.direction, true)

            setPointImage("#upStationCrossOver", data.points.upstationcrossover.direction, true)

            setPointImage("#downStationCrossOver", data.points.downstationcrossover.direction, true)

            setPointImage("#upSiding1", data.points.upsiding1.direction, false)
            setPointImage("#upSiding2", data.points.upsiding2.direction, false)

            setPointImage("#downSiding1", data.points.downsiding1.direction, false)
            setPointImage("#downSiding2", data.points.downsiding2.direction, false)

            setPointImage("#upSiding", data.isolators.topsidingup.enabled, false)
            setPointImage("#stationSiding", data.isolators.stationsidingdown.enabled, false)
            setPointImage("#downSidingLower", data.isolators.bottomsidingdown.enabled, false)
            setPointImage("#downSidingUpper", data.isolators.topsidingdown.enabled, false)

        }

        $(function() {
            $("#upMainCrossOverLever").click(function() {togglePoint("upmaincrossover")})
            $("#downMainCrossOverLever").click(function() {togglePoint("downmaincrossover")})
            $("#stationEntranceLever").click(function() {togglePoint("stationentrancecrossover")})
            $("#downStationCrossOverLever").click(function() {togglePoint("downstationcrossover")})
            $("#upStationCrossOverLever").click(function() {togglePoint("upstationcrossover")})
            $("#upSiding1Lever").click(function() {togglePoint("upsiding1")})
            $("#upSiding2Lever").click(function() {togglePoint("upsiding2")})
            $("#downSiding1Lever").click(function() {togglePoint("downsiding1")})
            $("#downSiding2Lever").click(function() {togglePoint("downsiding2")})

            $("#upSidingLever").click(function() {togglePoint("topsidingup")})
            $("#stationSidingLever").click(function() {togglePoint("stationsidingdown")})
            $("#downSidingLowerLever").click(function() {togglePoint("bottomsidingdown")})
            $("#downSidingUpperLever").click(function() {togglePoint("topsidingdown")})

            getState()
            })
    </script>
</head>
  
<body>
<div class="a" style="position:relative; height: 70px; margin-left: 50px">
<a class="btn btn-primary btn-lg" href="panel.html" role="button">Panel</a>
<a class="btn btn-default btn-lg" href="controllers.html" role="button">Controllers</a>
</div>

<div class="paneldiv" style="position:relative; width: 100%; height: 280px">
    <img src="png/panel.png" style="position: absolute; top:0; left:0; width:900px height: 250px">


    <!-- Outer -->
    <div id="upMainCrossOverLower" class="point up-main-crossover-lower"></div>
    <div id="upMainCrossOverUpper" class="point up-main-crossover-upper"></div>

    <div id="downMainCrossOverLower" class="point down-main-crossover-lower"></div>
    <div id="downMainCrossOverUpper" class="point down-main-crossover-upper"></div>

    <div id="stationEntranceLower" class="point station-entrance-lower"></div>
    <div id="stationEntranceUpper" class="point station-entrance-upper"></div>

    <div id="upStationCrossOverLower" class="point up-station-crossover-lower"></div>
    <div id="upStationCrossOverUpper" class="point up-station-crossover-upper"></div>

    <div id="downStationCrossOverLower" class="point down-station-crossover-lower"></div>
    <div id="downStationCrossOverUpper" class="point down-station-crossover-upper"></div>

    <div id="upSiding" class="point up-isolator"></div>
    <div id="upSiding1" class="point up-siding-1"></div>
    <div id="upSiding2" class="point up-siding-2"></div>

    <div id="stationSiding" class="point station-isolator"></div>
    <div id="downSidingLower" class="point down-siding-isolator-1"></div>
    <div id="downSidingUpper" class="point down-siding-isolator-2"></div>

    <div id="downSiding1" class="point down-siding-1"></div>
    <div id="downSiding2" class="point down-siding-2"></div>

</div>
 
<div style="position:relative; margin-left: 50px">
     <div id="upMainCrossOverLever" style="display: inline-block">       <img  id="upMainCrossOverLever_img" src="png/upMainCrossOverLever_off.png"></div>
     <div id="downMainCrossOverLever" style="display: inline-block">     <img  id="downMainCrossOverLever_img" src="png/downMainCrossOverLever_off.png"></div>
     <div id="stationEntranceLever" style="display: inline-block">       <img  id="stationEntranceLever_img" src="png/stationEntranceLever_off.png"></div>
     <div id="downStationCrossOverLever" style="display: inline-block">  <img  id="downStationCrossOverLever_img" src="png/downStationCrossOverLever_off.png"></div>
     <div id="upStationCrossOverLever" style="display: inline-block">    <img  id="upStationCrossOverLever_img" src="png/upStationCrossOverLever_off.png"></div>
     <div id="upSiding1Lever" style="display: inline-block">             <img  id="upSiding1Lever_img" src="png/upSiding1Lever_off.png"></div>
     <div id="upSiding2Lever" style="display: inline-block">             <img  id="upsiding2Lever_img" src="png/upSiding2Lever_off.png"></div>
     <div id="downSiding1Lever" style="display: inline-block">           <img  id="downSiding1Lever_img" src="png/downSiding1Lever_off.png"></div>
     <div id="downSiding2Lever" style="display: inline-block">           <img  id="downSiding2Lever_img" src="png/downSiding2Lever_off.png"></div>

     <div id="upSidingLever" style="display: inline-block">           <img  id="upSidingLever_img" src="png/upSidingLever_off.png"></div>
     <div id="stationSidingLever" style="display: inline-block">           <img  id="stationSidingLever_img" src="png/stationSidingLever_off.png"></div>
     <div id="downSidingLowerLever" style="display: inline-block">           <img  id="downSidingLowerLever_img" src="png/downSidingLowerLever_off.png"></div>
     <div id="downSidingUpperLever" style="display: inline-block">           <img  id="downSidingUpperLever_img" src="png/downSidingUpperLever_off.png"></div>
</div>
</body>
</html>
